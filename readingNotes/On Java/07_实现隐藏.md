# 7. 实现隐藏

- [7. 实现隐藏](#7-实现隐藏)
  - [7.0. 引言](#70-引言)
  - [7.1. package：库单元](#71-package库单元)
    - [7.1.1. 代码组织](#711-代码组织)
    - [7.1.2. 创建独一无二的包名](#712-创建独一无二的包名)
    - [7.1.3. 定制工具库](#713-定制工具库)
    - [7.1.4. 用 import 来改变行为](#714-用-import-来改变行为)
    - [7.1.5. 关于包的忠告](#715-关于包的忠告)

## 7.0. 引言

- **重构（refactoring）** 的主要动机之一，就是重写已经能正常工作的代码，提升其可读性、可理解性和可维护性。

- 面向对象设计的一个主要考虑是 *<u>“将变化的事物与保持不变的事物分离”</u>*。

- Java 提供了`访问修饰符（access specifier）` 来允许库开发者说明哪些是对客户程序员可用的，哪些是不可用的。

- 访问控制级别从“最多方法”到“最少访问”依次是：`public`、`protected`、`包内访问（package access，没有关键字）` 和 `private`。

- 尽可能将所有内容保持为 `“私有”（private）`，而仅公开你希望客户程序员使用的方法。

## 7.1. package：库单元

- 一个包（package）包含了一组类，这些类通过同一个 `命名空间（namespace）` 组织在了一起。

- 如果想导入单个类，可以在 `import` 语句中指明这个类：

  ``` java
  import java.util.ArrayList;
  public class SingleImport {
      public static void main(String[] args) {
          ArrayList list = new ArrayList();
      }
  }
  ```

- 要导入所有内容，可以使用 `"*"` , 例如：

  ``` java
  import java.util.*;
  ```

- 我们之所以要导入，是为了提供一种管理命名空间的机制。所有类成员的名字都是相隔离的。

- Java 源代码文件，注意事项：
  - 一个 Java 源代码文件就是一个`编译单元`（有时也称`转译单元`）。
  - 每个编译单元必须有一个以`.java`结尾的文件名。
  - 在编译单元内，可以有一个`public`类， *<u>它必须于文件同名（包括大小写，但不包括.java文件扩展名）</u>* 。
  - *<u>每个编译单元中只能有一个`public`类；否则，编译器会报错</u>* 。
  - 如果该编译单元中有其他类，则在该包之外是看不到它们的，这是因为它们不是`public`的，而只是主`public`类的支持类（support class） 。

### 7.1.1. 代码组织

- 当编译一个 `.java` 文件时，文件中的每个类都会有一个输出文件。输出文件的名字就是其在 `.java` 文件中对应的类的名字，但扩展名为 `.class` 。因此，你可以从少量的 `.java` 文件中得到相当多的 `.class` 文件。

- 在 Java 中一个可运行程序就是一堆 `.class` 文件，可以使用 `jar` 归档器将它们打包并压缩成一个 `Java档案文件（JAR）`。Java 解释器负责查找，加载和解释这些文件。

- 库就是一组这样的类文件（.class 文件）。每个源文件通常都有一个 `public` 类和任意数量的`非 public` 类，因此每个源文件都有一个公共组件。如果想让这些组件都属于一个命名空间，可以使用 `package 关键字`。

- 如果使用 `package` 语句，*<u>那它必须出现在文件中的第一个非注释处</u>* 。

  ``` java
  package hiding;
  ```

  - 假设文件名是 `MyClass.java`。 这意味着该文件只能有一个 `public` 类，并且该类的名称必须是 `MyClass（包含大小写）`，例如：

    ``` java
    package hiding.mypackage;
    public class MyClass{
        // ...
    }
    ```

  - 现在，如果有人想要使用`MyClass`或`hading.mypackage`里的任何其他 `public` 类，就必须用 `import` 关键字来说使 `hading.mypackage` 中的名称可用。另一种方式是 `提供完全限定的名称`，例如：

    ``` java
    import hiding.mypackage.MyClass;
    public class ImportedMyClass {
        public static void main(String[] args) {
            var m1 = new hiding.mypackage.MyClass(); // 完全限定的名称
            var m2 = new MyClass();
        }
    }
    ```

- `package` 和 `import` 关键字将单个全局命名空间分隔开，这样名称就不会发生冲突了。

### 7.1.2. 创建独一无二的包名

- 创建包名的方式：
  - package 名称的第一部分是类创建者的反向的因特网域名。因为因特网域名是唯一的
  - 反向的因特网域名后面再加上库名称；例如：`com.mindviewinc.simple`；
  - *<u>包名全部小写；</u>*

- 冲突解决：
  - 如果通过 `*` 导入的两个库包含了相同的名称，可以这样写： 
  
  ``` java
  java.util.Vector v = new java.util.Vector();
  ```

### 7.1.3. 定制工具库

- 有了这些知识，就可以创建自己的工具库来减少或消除重复代码来;
- 可以使用 `import static` 语句来导入工具类中的`静态方法`;

### 7.1.4. 用 import 来改变行为

- Java缺少的一个功能是 C语音的`条件编译（conditional compilation）`，你可以通过更改一个开关设置来获得不同的行为，而无需更改任何其他代码。这常用于解决代码跨平台。但Java旨在跨平台，因此不需要这样的功能。

### 7.1.5. 关于包的忠告

- 当创建一个包并给其命名时，你就隐式地指定来目录结构。这个包必须位于其名称指定的目录中，并且该目录必须可以从 `CLASSPATH` 开始搜索到。

