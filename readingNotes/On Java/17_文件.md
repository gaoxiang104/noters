# 17. 文件

- [17. 文件](#17-文件)
  - [17.1. 文件和目录路径](#171-文件和目录路径)

> `java.nio.file` 其中 `nio` 中的 `n` 以前是指 `new（新的）`，现在是指 `non-blocking（非阻塞）` ，`io` 是指 `input/output（输入/输出）` 。

- 本章将研究操作文件的两个基本组件：
  1. 文件或目录的路径；
  2. 文件本身；

## 17.1. 文件和目录路径

- <u>`Path` 对象代表的是一个文件或目录的路径，它是在不同的操作系统和文件系统之上的抽象。它的目的是，在构建路径时，我们不必注意底层的操作系统，我们的代码不需要重写就能在不同的操作系统上工作。</u>

- `java.nio.file.Paths` 类包含了重载的 `static get()` 方法，可以接受一个 `String` 序列，或一个 **`统一资源标识符（Uniform Resource Identifier，URI）`** ，然后将其转化为一个 `Path` 对象：

    ``` java
    import java.io.*;
    import java.net.URI;
    import java.nio.file.*;
    public class PathInfo {
        static void show(String id, Object p) {
            System.out.println(id + p);
        }

        static void info(Path p) {
            show("toString:\n ", p);
            show("Exists: ", Files.exists(p)); // 文件是否存在
            show("RegularFile: ", Files.isRegularFile(p)); // 是否常规文件
            show("Directory: ", Files.isDirectory(p)); // 是否是目录
            show("Absolute: ", p.isAbsolute()); // path 是否是完整的绝对路径
            show("FileName: ", p.getFileName()); // 获取文件名
            show("Parent: ", p.getParent()); // 获取父目录
            show("Root: ", p.getRoot()); // 将此路径的根组件作为path对象返回，如果此路径没有根组件，则返回null。
            System.out.println("************************");
        }

        public static void main(String[] args) {
            System.out.println(System.getProperty("os.name"));

            info(Paths.get("c:", "path", "to", "nowhere", "NoFile.txt"));

            Path p = Paths.get("src/main/java/pers/xgo/onjava/chapter17_files/PathInfo.java");
            info(p);

            Path ap = p.toAbsolutePath();
            info(ap);
            info(ap.getParent());

            try {
                info(p.toRealPath()); // 真实路径
            } catch (IOException e) {
                throw new RuntimeException(e);
            }

            URI u = p.toUri();
            System.out.println("URI:\n " + u);
            Path puri = Paths.get(u);
            System.out.println(Files.exists(puri));
            File f = ap.toFile();  // 不要被骗
        }
    }
    ```

  - 文档中对 “真实” 路径的定义有点模糊，因为它取决于特定的文件系统。例如，如果文件名的比较不区分大小写，即使路径因为大小写的原因看起来不是完全一样，匹配也会成功。在这样的平台上，`toRealPath()` 返回的 `Path` 会使用实际的大小写。它还会删除任何多余的元素。

  - 文件的 `URI` 是这样的：`file:///Users/gaoxiang/Projects/github/notes/readingNotes/On%20Java/code/src/main/java/pers/xgo/onjava/chapter17_files/PathInfo.java` ，但 `URI` 可以用来描述大多数事物，不仅限于文件。然后，我们成功地将 `URI` 转回到了一个 `Path` 之中。

  - 调用 `toFile()` 来生成一个 `File` 对象。这看起来可能会得到一个类似文件的东西（毕竟称为 `File`），但这个方法之所以存在，只是为了向后兼容旧的做事方式。`File` 实际上意味着一个文件或一个目录。


